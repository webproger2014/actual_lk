(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"0fe5":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"project"}},[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"text-h4 xs-text-h4"},[t._v("\n      Проект дома\n    ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.statusProject,expression:"statusProject === 2"}],staticClass:"q-pa-md"},[a("q-icon",{attrs:{size:"22px",name:"warning",color:"orange"}}),a("span",{staticClass:"text-caption q-ml-sm"},[t._v("У Вас нет проекта")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.statusProject,expression:"statusProject === 1"}]},[t.project.url_ar?a("div",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){return t.$refs.doc.open(e,t.$store.state.constant.CDN_DOMAIN+t.project.url_ar)}}},[a("q-item-section",{attrs:{avatar:""}},[a("img",{staticClass:"cur",attrs:{src:"/statics/icons/pdf_min.png"}})]),a("q-item-section",[a("q-item-label",{attrs:{lines:"1"}},[t._v("Архитектурный раздел")])],1),a("q-item-section",{attrs:{side:""}},[a("q-icon",{attrs:{name:"visibility",color:"grey"}})],1)],1)],1):t._e(),t.project.url_cr?a("div",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){return t.$refs.doc.open(e,t.$store.state.constant.CDN_DOMAIN+t.project.url_cr)}}},[a("q-item-section",{attrs:{avatar:""}},[a("img",{staticClass:"cur",attrs:{src:"/statics/icons/pdf_min.png"}})]),a("q-item-section",[a("q-item-label",{attrs:{lines:"1"}},[t._v("Конструктивный раздел")])],1),a("q-item-section",{attrs:{side:""}},[a("q-icon",{attrs:{name:"visibility",color:"grey"}})],1)],1)],1):t._e()]),a("printdoc",{ref:"doc"})],1)},i=[],s=a("6b12"),c={name:"project",components:{printdoc:s["a"]},data:function(){return{statusProject:0,project:{id:null,user_id:null,contract_number:null,contract_date:null,name:null,url_ar:"",url_cr:""}}},created:function(){this.$_getProject(),this.$_watching()},methods:{$_watching:function(){var t=this;this.$watch("$store.state.user.activeContract",(function(){t.$_getProject()}))},$_getProject:function(){var t=this;if(this.$_.isEmpty(this.$store.state.user.activeContract))this.project=[],this.statusProject=2;else{var e=this.$axios.get("contract/get_contract/".concat(this.$store.state.user.activeContract.id));e.then((function(e){t.$_.isEmpty(e.data)?t.statusProject=2:(t.project=e.data,t.statusProject=1)})).catch((function(e){t.statusProject=2}))}}}},o=c,r=(a("57a7"),a("2877")),l=a("eebe"),u=a.n(l),d=a("0016"),p=a("66e5"),f=a("4074"),h=a("0170"),m=a("714f"),v=Object(r["a"])(o,n,i,!1,null,"ce52f562",null);e["default"]=v.exports;u()(v,"components",{QIcon:d["a"],QItem:p["a"],QItemSection:f["a"],QItemLabel:h["a"]}),u()(v,"directives",{Ripple:m["a"]})},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},"57a7":function(t,e,a){"use strict";var n=a("9057"),i=a.n(n);i.a},"6b12":function(t,e,a){"use strict";var n,i,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",attrs:{id:"printdoc"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.ts(e)}}},[a("iframe",{ref:"filePrint",staticStyle:{display:"none"},attrs:{src:""}}),a("q-dialog",{attrs:{maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("q-card",{staticClass:"full-width",staticStyle:{overflow:"hidden"}},[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"keyboard_arrow_left"},on:{click:t.closeDialog}}),t._v("\n          Вернуться\n\n          "),a("div",{staticClass:"text-center toolbar-center"},[a("q-btn",{attrs:{flat:"",color:"white",icon:"zoom_out",size:"13px"},on:{click:function(e){t.scale-=.1}}}),t._v("\n            "+t._s((t.scale-1.5).toFixed(1))+"\n            "),a("q-btn",{attrs:{flat:"",color:"white",icon:"zoom_in",size:"13px"},on:{click:function(e){t.scale+=.1}}}),t._v("\n\n            стр "+t._s(t.numPages)+"\n          ")],1)],1),a("div",{staticClass:"pdf-container"},[a("document",t._b({on:{countpages:t.countPages}},"document",{data:t.data,scale:t.scale},!1))],1)],1)],1)],1)},c=[],o=a("967e"),r=a.n(o),l=(a("6762"),a("2fdb"),a("96cf"),a("fa84")),u=a.n(l),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"wrapperiframe",staticClass:"canvas-container text-center"},[a("q-circular-progress",{directives:[{name:"show",rawName:"v-show",value:!t.pages.length,expression:"!pages.length"}],staticClass:"q-ma-md absolute-center",attrs:{indeterminate:"",size:"40px",color:"light-blue-6"}}),t._l(t.pages,(function(e,n){return a("div",{key:n},[a("page",t._b({},"page",{page:e,scale:t.scale},!1))],1)}))],2)},p=[],f=(a("551c"),a("ac6a"),a("cadf"),a("06db"),a("5df3"),a("9511")),h=a.n(f),m=a("f3e3"),v=a.n(m),g={props:["page","scale"],render:function(t){var e=this.canvasAttrs;return t("canvas",{attrs:e})},created:function(){this.viewport=this.page.getViewport({scale:this.scale})},mounted:function(){this.drawPage()},computed:{canvasAttrs:function(){var t=this.viewport,e=t.width,a=t.height,n=this.canvasStyle;return{width:e,height:a,style:n}},canvasStyle:function(){var t=this.actualSizeViewport,e=t.width,a=t.height,n=window.devicePixelRatio||1,i=[e,a].map((function(t){return Math.ceil(t/n)})),s=v()(i,2),c=s[0],o=s[1];return"width: ".concat(c,"px; height: ").concat(o,"px;")},actualSizeViewport:function(){return this.viewport.clone({scale:this.scale-1.5})}},methods:{drawPage:function(){var t=this.viewport,e=this.$el.getContext("2d"),a={canvasContext:e,viewport:t};this.renderTask=this.page.render(a)}}},w=g,_=a("2877"),b=Object(_["a"])(w,n,i,!1,null,"1300dd0b",null),P=b.exports,x={props:["data","scale"],components:{page:P},data:function(){return{pdf:void 0,pages:[]}},created:function(){this.fetchPDF()},methods:{fetchPDF:function(){var t=this;if(this.data){var e={withCredentials:!1};this.data.includes(".pdf")?e["url"]=this.data:e["data"]=atob(this.data),h.a.getDocument(e).promise.then((function(e){t.pdf=e}))}}},watch:{data:function(){this.fetchPDF()},pdf:function(t){var e=this;this.pages=[],this.$emit("countpages",t.numPages);var a=this.$_.range(1,t.numPages+1).map((function(e){return t.getPage(e)}));Promise.all(a).then((function(t){return e.pages=t}))}}},$=x,j=a("eebe"),C=a.n(j),q=a("58ea"),k=Object(_["a"])($,d,p,!1,null,"5dc4132c",null),y=k.exports;C()(k,"components",{QCircularProgress:q["a"]});var D={name:"printdoc",components:{document:y},data:function(){return{dialog:!1,numPages:void 0,srcPdf:"",percentLoad:"",indexLoad:1,scale:3,data:""}},methods:{print:function(t){var e=this.$refs.filePrint;this.srcPdf=encodeURIComponent(t),e.contentWindow.focus(),e.onload=function(){e.contentWindow.print()}},closeDialog:function(){this.dialog=!1,this.data=null,this.numPages=void 0,this.scale=3},open:function(t,e){var a=this;null===t.target.getAttribute("nopen")&&(this.srcPdf=encodeURIComponent(e),this.dialog=!0,this.$nextTick((function(){setTimeout((function(){a.$_loadPdf(e)}),500)})))},$_loadPdf:function(t){var e=this;return u()(r.a.mark((function a(){return r.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.includes("http")?e.$axios.post("parse/file/pdf",{src:t}).then((function(t){e.data=t.data})):e.data=t;case 1:case"end":return a.stop()}}),a)})))()},countPages:function(t){this.numPages=t}}},z=D,N=(a("8989"),a("24e8")),Q=a("f09f"),I=a("65c6"),E=a("9c40"),O=Object(_["a"])(z,s,c,!1,null,"86849036",null);e["a"]=O.exports;C()(O,"components",{QDialog:N["a"],QCard:Q["a"],QToolbar:I["a"],QBtn:E["a"]})},8989:function(t,e,a){"use strict";var n=a("9f00"),i=a.n(n);i.a},9057:function(t,e,a){},"9f00":function(t,e,a){}}]);